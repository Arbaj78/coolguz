import{r as i,j as e}from"./index-DRQ8sg-H.js";import{l as w}from"./logo-dark-CUqbT7Yx.js";import{S as y,a as j,s as v}from"./seoData-BTvm6_zB.js";const E=()=>{const[l,g]=i.useState({name:"",email:""}),[m,p]=i.useState(!1),[f,c]=i.useState(null),s=i.useRef(null),h=r=>{const{name:n,value:t}=r.target;g(a=>({...a,[n]:t}))},x=async r=>{if(r.preventDefault(),c(null),!l.email.match(/^\S+@\S+\.\S+$/)){c("Please enter a valid email address.");return}p(!0);const n=Math.floor(1e7+Math.random()*9e7).toString();try{const t=await fetch("https://n8n.srv871973.hstgr.cloud/webhook/redirect_url",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:l.name.trim(),email:l.email.trim(),webhookId:n})});if(!t)throw new Error("No response from server");const a=t.clone();try{const o=await t.json();if(o.link&&o.link.startsWith("http"))d(o.link,n);else throw new Error("No redirect link in response")}catch{const o=await a.text();try{const u=JSON.parse(o);if(u.link){d(u.link,n);return}}catch{}if(o.startsWith("http")){d(o,n);return}throw new Error(`Unexpected response: ${o}`)}}catch(t){console.error("Submission error:",t),c(t.message||"Something went wrong. Please try again.")}finally{p(!1)}},d=(r,n)=>{const t=window.open("","authPopup","width=500,height=600,menubar=no,toolbar=no,location=no,status=no,resizable=no,scrollbars=no");t?(t.location.href=r,s.current=t,b(n)):window.location.href=r},b=r=>{let n=0;const t=20,a=setInterval(async()=>{if(n++,n>t){clearInterval(a),c("Login timed out. Please try again."),s.current&&s.current.close();return}try{(await(await fetch(`https://your-backend-url.onrender.com/webhook-status/${r}`)).json()).received&&(clearInterval(a),s.current&&(s.current.close(),s.current=null),console.log("Webhook received, popup closed."))}catch(o){console.error("Polling error:",o),clearInterval(a)}},3e3)};return i.useEffect(()=>{const r=()=>{s.current&&s.current.close()};return window.addEventListener("beforeunload",r),()=>window.removeEventListener("beforeunload",r)},[]),e.jsxs("div",{className:"min-h-screen bg-[#ffb477] flex flex-col items-center justify-center p-4",children:[e.jsx(y,{...v["/linkedin-agent"],url:`${j.domain}/linkedin-agent`}),e.jsx("div",{className:"mb-8",children:e.jsx("img",{src:w,alt:"CoolGuyz Logo",className:"w-44 mx-auto"})}),e.jsxs("div",{className:"bg-[#f77f27] p-8 rounded-xl shadow-2xl w-full max-w-md",children:[e.jsx("h2",{className:"text-white text-2xl font-bold text-center mb-6",children:"LinkedIn Agent"}),f&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:f}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"name",value:l.name,onChange:h,placeholder:"Your Name",required:!0,className:"w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ffb477] text-center"}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:h,placeholder:"Your Email",required:!0,className:"w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#ffb477] text-center"}),e.jsx("button",{type:"submit",disabled:m,className:"w-full py-3 px-4 bg-white text-[#f77f27] font-bold rounded-lg hover:bg-gray-100 transition-colors duration-200 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center",children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"Processing"}),e.jsx("span",{className:"animate-spin",children:"ðŸ˜Ž"})]}):"Get Started"})]})]})]})};export{E as default};
