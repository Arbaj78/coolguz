import{r as i,j as t}from"./index-DRQ8sg-H.js";import{l as b}from"./logo-dark-CUqbT7Yx.js";const j=()=>{const[l,g]=i.useState({name:"",email:""}),[m,p]=i.useState(!1),[h,c]=i.useState(null),a=i.useRef(null),f=r=>{const{name:n,value:e}=r.target;g(s=>({...s,[n]:e}))},x=async r=>{if(r.preventDefault(),c(null),!l.email.match(/^\S+@\S+\.\S+$/)){c("Please enter a valid email address.");return}p(!0);const n=Math.floor(1e7+Math.random()*9e7).toString();try{const e=await fetch("https://n8n.srv871973.hstgr.cloud/webhook/redirect_url_instagram",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:l.name.trim(),email:l.email.trim(),webhookId:n})});if(!e)throw new Error("No response from server");const s=e.clone();try{const o=await e.json();if(o.link&&o.link.startsWith("http"))d(o.link,n);else throw new Error("No redirect link in response")}catch{const o=await s.text();try{const u=JSON.parse(o);if(u.link){d(u.link,n);return}}catch{}if(o.startsWith("http")){d(o,n);return}throw new Error(`Unexpected response: ${o}`)}}catch(e){console.error("Submission error:",e),c(e.message||"Something went wrong. Please try again.")}finally{p(!1)}},d=(r,n)=>{const e=window.open("","authPopup","width=500,height=600,menubar=no,toolbar=no,location=no,status=no,resizable=no,scrollbars=no");e?(e.location.href=r,a.current=e,w(n)):window.location.href=r},w=r=>{let n=0;const e=20,s=setInterval(async()=>{if(n++,n>e){clearInterval(s),c("Login timed out. Please try again."),a.current&&a.current.close();return}try{(await(await fetch(`https://your-backend-url.onrender.com/webhook-status/${r}`)).json()).received&&(clearInterval(s),a.current&&(a.current.close(),a.current=null),console.log("Webhook received, popup closed."))}catch(o){console.error("Polling error:",o),clearInterval(s)}},3e3)};return i.useEffect(()=>{const r=()=>{a.current&&a.current.close()};return window.addEventListener("beforeunload",r),()=>window.removeEventListener("beforeunload",r)},[]),t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-orange-400 flex flex-col items-center justify-center p-4 font-sans",children:[t.jsx("div",{className:"mb-8",children:t.jsx("img",{src:b,alt:"CoolGuyz Logo",className:"w-44 mx-auto"})}),t.jsxs("div",{className:"bg-white/20 backdrop-blur-lg p-8 rounded-xl shadow-2xl w-full max-w-md",children:[t.jsx("h2",{className:"text-white text-3xl font-bold text-center mb-6",children:"Instagram Agent"}),h&&t.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-center",children:h}),t.jsxs("form",{onSubmit:x,className:"space-y-6",children:[t.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,placeholder:"Your Name",required:!0,className:"w-full p-3 rounded-lg border-none bg-white/50 text-gray-800 placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-pink-500 text-center transition"}),t.jsx("input",{type:"email",name:"email",value:l.email,onChange:f,placeholder:"Your Email",required:!0,className:"w-full p-3 rounded-lg border-none bg-white/50 text-gray-800 placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-pink-500 text-center transition"}),t.jsx("button",{type:"submit",disabled:m,className:"w-full py-3 px-4 bg-gradient-to-r from-pink-500 to-orange-500 text-white font-bold rounded-lg hover:opacity-90 transition-all duration-300 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center transform hover:scale-105",children:m?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-2",children:"Processing"}),t.jsx("span",{className:"animate-spin",children:"ðŸ˜Ž"})]}):"Get Started"})]})]})]})};export{j as default};
